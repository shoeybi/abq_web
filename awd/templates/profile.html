{% extends 'base.html' %}

{% block extrahead_base %}
<title> Profile </title>
{% endblock %}
   
{% block extraheader_base %}

<div id="profilename">
  <p> {{user.first_name}} {{user.last_name}} </p>
</div>

{% if abqUser.abaqual_status == "EX" %} 
<div id="company_reg" >
  <form method="post">
    {% csrf_token %}
    <div id="company_reg_input">
      <label for="name"{% if company_form.name.errors %} class="error2" {% endif %}> company name </label> {{ company_form.name }} 
    </div>
    <div id="company_reg_button">
      <input type="submit" name="company_reg" value="register your company" />
    </div>
    {% if company_form.errors %} 
    <p class="error">  {{company_form.name.errors.as_text}} </p> 
    {% endif %}
  </form>
</div>
{% endif %}


{% for company in company_dic.values %}

<div id="company">
  
  <div id="name">
    <p> {{ company.company }} </p>
  </div>    

  <div id="left"> 
    
    <div id="workspaces">
      {% for workspace in company.workspaces %}
      <div id="workspace">
	<figure>
	  <a href="{{workspace.instance_url}}" alt="{{workspace.name}}">
	    <img src="{{workspace.image.url}}" alt="">
	  </a>
	  <figcaption>{{workspace.name}}</figcaption>
	</figure>
      </div> 

      {% endfor %}
    </div>
    
    <div id="workspace_launch" >
      <form method="post">
	{% csrf_token %}
	{{company.workspace_launch_form.company_name}}
	{{company.workspace_launch_form.hardware}}
	{{company.workspace_launch_form.os}}
	<input type="submit" name="workspace_launch" value="launch workspace" />
      </form>
      <p class="error"> {{company.workspace_launch_form.errors.as_text}}</p>
    </div>

  </div>

  <div id="right">
    
    <div id="employees">
      {% for employee in company.employees_accepted %}
      <div id="employee_accepted">
	<p> {{employee.user.first_name}} {{employee.user.last_name}}</p>
      </div> 
      {% endfor %}
      {% for employee in company.employees_pending %}
      <div id="employee_pending">
	<p> {{employee.user.first_name}} {{employee.user.last_name}} (pending)</p>
      </div> 
      {% endfor %}
    </div>
    
    <div id="add_employee" >
      <p> {{company.employment_form.errors.as_text}}</p>
      <form method="post">
	{% csrf_token %}
	{{company.employment_form.abqUser}}
	{{company.employment_form.company_name}}
	<input type="submit" name="invite_employee" value="invite" />
      </form>
    </div>
     
  </div>
  
</div>

{% endfor %}



{% for company in company_dic_employee.values %}

<p> {{ company.company }} </p>

<div id="workspaces">
  {% for workspace in company.workspaces %}
  <div id="workspace">
    <a href="url"> <img src="{{workspace.image.url }}" /> </a>
    <p> {{workspace.name}} </p>
  </div> 
  {% endfor %}
</div>

<div id="owner">
<p> Owner: {{company.owner.user.first_name}} {{company.owner.user.last_name}} </p>
</div>

<div id="employees">
  {% for employee in company.employees %}
  <div id="employee_accepted">
    <p> {{employee.user.first_name}} {{employee.user.last_name}}</p>
  </div> 
  {% endfor %}
</div>

{% endfor %}

{% endblock %}
