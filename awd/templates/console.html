{% extends "base.html" %}

{% block extrahead_base %}
<title> Console </title>
{% endblock %}


<!-- company registration for the experts -->
{% block content_base %}
{% if abq_user.abaqual_status == "EX" %} 
<div id="company_reg" >
  <form method="post">
    {% csrf_token %}
    <label 
       {% if company_reg_form.non_field_errors %} 
       class="error_highlight" 
       {% endif %} 
       > 
      Company name 
    </label> 
    {{ company_reg_form.name }} 
    <input type="submit" name="register_company" value="Start your company"/>
    {% if company_reg_form.errors %} 
    <p class="error_message">  
      {{company_reg_form.non_field_errors.as_text}} 
    </p> 
    {% endif %}
  </form>
</div>
{% endif %}


<!-- loop through all the companies -->
{% for company_dict in companies_dict.values %}
<div id="company" >
  
  <!-- company name and termination -->
  <div id="name">
    <form method="post">
      {% csrf_token %}
      <label> {{ company_dict.company.name }} </label>
      <input name="company_name" value="{{ company_dict.company.name }}"
	     type="hidden" >
      <input name="dissolve_company" class="terminate20" 
	     value="" type="submit" >
    </form>
  </div>
  <div class="clear"> </div>
  
  <!-- workspace -->
  <div id="workspaces" >
    <!-- workspaces and termination -->
    {% for item in company_dict.workspaces_list %}
    <!-- workspace -->
    <div id="workspace" >
      <figure>
	<a href="{{item.workspace.instance_url}}" 
	   alt="{{item.workspace.name}}">
	  <img src="{{item.workspace.image.url}}" alt="">
	</a>
	<figcaption>
	  <!-- termiation -->
	  <form method="post">
	    {% csrf_token %}
	    {{item.termination_form.region}}
	    {{item.termination_form.instance_id}}
	    {{item.termination_form.company_name}}
	    <label> {{item.workspace.name}} </label>
	    <input type="submit" name="terminate_workspace" 
		   class="terminate20" value="" />
	  </form>
	</figcaption>
      </figure>
      <p class="error"> {{item.termination_form.errors.as_text}}</p>
    </div>
    {% endfor %}


    <!-- launch a new workspace -->
    <div id="launch">
      <form method="post">
	{% csrf_token %}
	{{company_dict.workspace_launch_form.company_name}}
	{{company_dict.workspace_launch_form.name}}
	<p class="error_message"> 
	  {{ company_dict.workspace_launch_form.name.errors.as_text }}
	</p>
	{{company_dict.workspace_launch_form.hardware}}
	<p class="error_message"> 
	  {{ company_dict.workspace_launch_form.hardware.errors.as_text }}
	</p>
	{{company_dict.workspace_launch_form.os}}
	<p class="error_message"> 
	  {{ company_dict.workspace_launch_form.os.errors.as_text }}
	</p>
	<input type="submit" name="workspace_launch" 
	       class="add20" value="" />
      </form>
    </div>
    <div class="clear"> </div>
        
  </div>
  
  
  <!-- Team -->
  <div id="team">
    <!-- team mebers -->
    <div id="owner">
      <p>{{company_dict.company.owner.user.first_name }} 
	{{company_dict.company.owner.user.last_name }} (owner) 
      </p>
    </div>
    {% for item in company_dict.employees_list %}
    <div id="employee">
      <!-- employment termination -->
      <form method="post">
	{% csrf_token %}
	<label>
	  {{item.employee.user.first_name}} {{item.employee.user.last_name}} 
	  {% if not item.accepted %}
	  (pending)
	  {% endif %}
	</label>
	{{item.termination_form.company_name}}
	{{item.termination_form.username}}
	<input type="submit" name="terminate_employment" 
	       class="terminate20", value="" />
      </form>
    </div>
    {% endfor %}
    
    <!-- new employee -->
    <div id="invite">
      <form method="post">
	{% csrf_token %}
	{{company_dict.employment_form.abqUser}}
	{{company_dict.employment_form.company_name}}
	<input type="submit" name="invite_employee" 
	       class="add20" value="" />
      </form>
      <p class="error_message"> 
	{% if company_dict.employment_form.non_field_errors %}
	{{company_dict.employment_form.non_field_errors.as_text}}
	{% endif %}
      </p>
    </div>
  </div>  
  
</div>
<div class="clear"> </div>
{% endfor %}



{% endblock %}
  


